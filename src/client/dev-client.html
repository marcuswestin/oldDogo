<!doctype html>
<html><head>
	<title>Fun!</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<style type="text/css">
		html, body, iframe { margin:0; width:100%; height:100%; }
		#error { display:none; color:red; margin:0 10px; }
	</style>
</head><body>
	<script src="/socket.io/socket.io.js"></script>
	<pre id="error"></pre>
	<div id="output"></div>
	<script>
		var socket = io.connect('http://'+location.host),
			error = document.getElementById('error'),
			output = document.getElementById('output')

		socket.on('change', function (data) {
			if (data.error) {
				error.style.display = 'block'
				error.innerHTML = ''
				error.appendChild(document.createTextNode(data.error))
			} else {
				error.style.display = 'none'
				try {
					output.innerHTML = ''
					var iframe = document.createElement('iframe')
					iframe.style.height = iframe.style.width = '100%'
					iframe.frameBorder = 0
					output.appendChild(iframe)
					var doc = iframe.contentWindow.document
					doc.open()
					doc.write(data.html)
					doc.close()
				} catch(e) {
					alert("dev-client error: " + e)
				}
			}
		});
	</script>
</body></html>
